//This is for the update statements with ASYNC and AWAIT ALL //

CREATE OR REPLACE PROCEDURE ord_update_set_01()
RETURNS VARCHAR
LANGUAGE SQL
AS
BEGIN
  ASYNC (UPDATE DEMO_DB.DEMO_SCHEMA.ORDERS_001 SET O_ORDERDATE='2025-01-01' WHERE O_ORDERDATE='1992-01-10');
  AWAIT ALL;
END;


CREATE OR REPLACE PROCEDURE ord_update_set_02()
RETURNS VARCHAR
LANGUAGE SQL
AS
BEGIN
  ASYNC (UPDATE DEMO_DB.DEMO_SCHEMA.ORDERS_001 SET O_ORDERDATE='2025-01-01' WHERE O_ORDERDATE='1992-01-11');
  AWAIT ALL;
END;



CREATE OR REPLACE PROCEDURE common_call_upd()
RETURNS VARCHAR
LANGUAGE SQL
AS
BEGIN
  ASYNC (CALL ord_update_set_01());
  ASYNC (CALL ord_update_set_02());
  AWAIT ALL;
END;

CALL common_call_upd();



// Scripts without ASYNC //
CREATE OR REPLACE PROCEDURE ord_update_set_001()
RETURNS VARCHAR
LANGUAGE SQL
AS
BEGIN
   UPDATE DEMO_DB.DEMO_SCHEMA.ORDERS_001 SET O_ORDERDATE='2025-01-01' WHERE O_ORDERDATE='1992-01-16';
END;


CREATE OR REPLACE PROCEDURE ord_update_set_002()
RETURNS VARCHAR
LANGUAGE SQL
AS
BEGIN
  UPDATE DEMO_DB.DEMO_SCHEMA.ORDERS_001 SET O_ORDERDATE='2025-01-01' WHERE O_ORDERDATE='1992-01-18';
END;



CREATE OR REPLACE PROCEDURE common_call_updates()
RETURNS VARCHAR
LANGUAGE SQL
AS
BEGIN
  CALL ord_update_set_001();
  CALL ord_update_set_002();
END;

CALL common_call_updates();
